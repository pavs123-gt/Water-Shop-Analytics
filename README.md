# üíß Water Shop Monitoring & Analytics System
### CCTV-Based Customer, Payment & Operational Analytics
The **Water Shop Monitoring & Analytics System** automates customer tracking and operational analytics using computer vision and data analytics.
The system identifies customers using **facial recognition**, tracks visit frequency, links transactions, detects unpaid customers, and analyzes peak business hours.

---

## Table of Contents
- [Project Overview](#project-overview)
- [Objectives](#objectives)
- [Features](#features)
- [Dataset Format](#dataset-format)
- [Project Structure](#project-structure)
- [Setup & Installation](#setup--installation)
- [Processing Pipeline](#processing-pipeline)
- [Analytics & Reports](#analytics--reports)
- [Dashboard & Visualization](#dashboard--visualization)
- [Tools Used](#tools-used)
- [Future Enhancements](#future-enhancements)
- [Author](#author)
 

---

##  Project Overview
The **Water Shop Monitoring & Analytics System** automates customer tracking and operational analytics using computer vision and data analytics.

The system identifies customers using **facial recognition**, tracks visit frequency, links transactions, detects unpaid customers, and analyzes peak business hours.

---

##  Objectives
- Identify customers using CCTV footage and facial recognition  
- Assign unique customer IDs  
- Track visit frequency per customer  
- Analyze payment methods (Cash / UPI / Coins)  
- Track water can usage and sales  
- Detect unpaid and repeat defaulters  
- Identify peak and idle business hours  
- Generate automated reports  

---

## Features
- Face detection and recognition from CCTV videos  
- Customer visit tracking and repeat analysis  
- Transaction and payment mode analytics  
- Can size and quantity tracking (10L, 20L, etc.)  
- Unpaid customer identification  
- Staff optimization using traffic analysis  
- Automated shop opening and closing time detection  
- Dashboard-based visualization  

---

## Dataset Format

### CCTV Footage
The CCTV footage used in this project is a **single continuous video of approximately 2 hours**, captured during normal water shop operating hours and **provided directly by the shop manager**.

üìπ **CCTV Video File:**  
üëâ [Download CCTV Footage](./dataset/cctv_footage.mp4)

- Used for customer detection, face recognition, and visit tracking  
- Captured from a fixed camera inside the shop  
- Represents real customer activity  

---
### Transaction Data
The transaction data used in this project is stored in a CSV file generated manually using a Python script to simulate real water shop transactions.

üìÑ **Transaction Dataset:**  
üëâ [View sample_transactions.csv](https://github.com/pavs123-gt/Water-Shop-Analytics/blob/main/sample_transactions.csv)

The `sample_transactions.csv` file contains **one row per customer transaction** and includes the following fields:

| Column Name        | Description |
|--------------------|-------------|
| transaction_id     | Unique ID for each transaction |
| timestamp          | Date and time of the transaction |
| customer_id        | Unique ID assigned to the customer |
| payment_mode       | Mode of payment (Cash / UPI / Coin) |
| can_size           | Size of water can (10L / 20L) |
| number_of_cans     | Number of cans purchased |
| amount             | Total transaction amount |
| payment_status     | Paid or Unpaid |

This dataset is used for:
- Payment mode analysis  
- Customer purchase behavior analysis  
- Unpaid and defaulter identification  
- Daily and monthly revenue analytics  

---

### Transaction Data Generation
The transaction dataset is generated by running the following Python script:

```bash
python general_sample_transaction.py
```

---

### Project Structure

```bash
WaterShopSystem/
‚îú‚îÄ‚îÄ generate_sample_transaction.py       ‚Üí Generates sample transactions
‚îú‚îÄ‚îÄ detection.py                         ‚Üí Handles detection logic
‚îú‚îÄ‚îÄ face_recognition_pipeline.py         ‚Üí Face recognition pipeline
‚îú‚îÄ‚îÄ run_visit_tracking_hog.py            ‚Üí Visit tracking using HOG
‚îú‚îÄ‚îÄ m_r_v.py                             ‚Üí Monthly/Revenue/Visit analytics
‚îú‚îÄ‚îÄ visit_analytics.py                   ‚Üí Analytics on customer visits
‚îú‚îÄ‚îÄ new_vs_returning_customers.py        ‚Üí Compare new vs returning customers
‚îú‚îÄ‚îÄ payment_and_can_analytics.py         ‚Üí Payment and can purchase analytics
‚îú‚îÄ‚îÄ plot_analytics_charts.py             ‚Üí Plot charts for analytics
‚îú‚îÄ‚îÄ test_visit_tracking.py               ‚Üí Tests for visit tracking
‚îú‚îÄ‚îÄ test_transaction.py                  ‚Üí Tests for transactions
‚îú‚îÄ‚îÄ test_can_shop_activity.py            ‚Üí Tests for can/shop activity
‚îú‚îÄ‚îÄ dashboard.py                          ‚Üí Streamlit dashboard
‚îú‚îÄ‚îÄ dashboard_final.py                    ‚Üí Final version of dashboard
‚îî‚îÄ‚îÄ cctv.mp4                              ‚Üí CCTV video input
```
---
##  Setup & Installation

Follow the steps below to set up the **Water Shop Monitoring & Analytics System**. This section includes **only environment setup and required libraries**, similar to your MFA example.

---

### 1Ô∏è‚É£ Create and Activate Conda Environment

```bash
conda create -n water_shop python=3.9 -y
conda activate water_shop
```

---

### 2Ô∏è‚É£ Install Core Data & Analytics Libraries

```bash
pip install pandas numpy scikit-learn
```

---

### 3Ô∏è‚É£ Install Visualization Libraries

```bash
pip install matplotlib seaborn streamlit
```

---

### 4Ô∏è‚É£ Install Computer Vision & Face Recognition Libraries

```bash
pip install opencv-python face_recognition
```

> ‚ö†Ô∏è `face_recognition` depends on **dlib**. If installation fails, ensure the following are installed:
>
> * CMake
> * C++ compiler (build-essential / Visual Studio Build Tools)

---

### 5Ô∏è‚É£ Install Backend / API Libraries (Optional)

```bash
pip install fastapi uvicorn
```

---

### 6Ô∏è‚É£ Install Database Libraries

```bash
pip install sqlalchemy
```

(Optional ‚Äì for PostgreSQL)

```bash
pip install psycopg2-binary
```

---

### 7Ô∏è‚É£ Verify Installation

```bash
python -c "import cv2, face_recognition, pandas, numpy, matplotlib, streamlit; print('Environment setup successful')"
```

---

### ‚ÑπÔ∏è Notes

* Python 3.8‚Äì3.10 is recommended.
* Use Conda for easier installation of `dlib` and OpenCV.
* TensorFlow is optional and only required for advanced or future enhancements.
* Compatible with Linux, macOS, and Windows.

